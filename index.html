<!DOCTYPE html>
<html>
<head>
    <title>Clasificador de Servicio Fuzzy</title>
</head>
<body>
    <h1>Clasificador de Calidad de Servicio</h1>
    <label for="espera">Tiempo de Espera (min):</label>
    <input type="number" id="espera" value="45"><br><br>
    
    <label for="comida">Calidad de Comida (0-10):</label>
    <input type="number" id="comida" value="7.5"><br><br>
    
    <button onclick="obtenerClasificacion()">Clasificar Servicio</button>
    
    <p id="resultado">Puntuación: </p>

    <script>
        // *******************************************************************
        // CAMBIO CLAVE: Usamos una URL relativa que Vercel resuelve al mismo dominio.
        // Vercel a menudo envuelve las APIs de Python en la ruta /api
        // *******************************************************************
        const API_URL = "/api/clasificar"; 

        async function obtenerClasificacion() {
            const tiempo = parseFloat(document.getElementById('espera').value);
            const comida = parseFloat(document.getElementById('comida').value);

            try {
                // La función 'fetch' usará automáticamente: https://proyecto-caso-5-ia.vercel.app/api/clasificar
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        tiempo_espera: tiempo,
                        calidad_comida: comida
                    })
                });

                // Si la respuesta no es 200 OK, lanzamos un error para ir al catch
                if (!response.ok) {
                    throw new Error(`Error HTTP: ${response.status} ${response.statusText}`);
                }

                const data = await response.json();
                document.getElementById('resultado').innerText = 
                    `Puntuación Final: ${data.puntuacion_final} / 100`;

            } catch (error) {
                // Mostramos el error de conexión o el error HTTP
                document.getElementById('resultado').innerText = "Error al conectar con la API. Detalles en la consola.";
                console.error('Error:', error);
            }
        }
    </script>
</body>
</html>
